# Malware Analysis

## Obfuscated Scripts

One type of obfuscation used by malware authors is the use of Base64 encoding for Windows PowerShell and other scripting languages.
In [CVE-2022-30190](https://www.bleepingcomputer.com/news/microsoft/microsoft-shares-mitigation-for-office-zero-day-exploited-in-attacks/), the creators used Base64 encoding to hide the dirty work:

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Interesting maldoc was submitted from Belarus. It uses Word&#39;s external link to load the HTML and then uses the &quot;ms-msdt&quot; scheme to execute PowerShell code.<a href="https://t.co/hTdAfHOUx3">https://t.co/hTdAfHOUx3</a> <a href="https://t.co/rVSb02ZTwt">pic.twitter.com/rVSb02ZTwt</a></p>&mdash; nao_sec (@nao_sec) <a href="https://twitter.com/nao_sec/status/1530196847679401984?ref_src=twsrc%5Etfw">May 27, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> 

Image was provided by security research team [nao_sec](https://nao-sec.org/). (As I'm writting this, a patch has not yet been released but a workaround involving deletion of a registry key to disable the vulnerable tool has been.)

There are a number of ways to decode Base64 encoded scripts, but one of the most popular is using [Cyberchef.com](https://gchq.github.io/CyberChef/). I highly recommend you become familiar with it. Along with the ability to decode obfuscated scripts (ie. base64, rot-13, etc.) it works great with decoding shellcode into x86 assembly instructions.


## Online Analysis Platforms

* [Virus Total](https://www.virustotal.com/gui/home/search) - Aka VT: The premiere virus database online.
* [Intezer Analyze](https://analyze.intezer.com/) - Similar to Virus Total, uses VT as one of many sources.
* [Pandora](https://pandora.circl.lu/submit) - Website and Github project by [CIRCL](https://www.circl.lu/) - The Computer Incident Response Centre of Luxembourg
